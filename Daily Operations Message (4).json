{
  "name": "Daily Operations Message",
  "description": null,
  "organizationId": 726929,
  "isEnabled": false,
  "crontab": null,
  "timezone": "America/Denver",
  "blockData": [
    {
      "top": 48,
      "left": 48,
      "uuid": "c4fef6f5-7ad9-4036-8225-d62c449c9bf9",
      "options": {},
      "pluginId": "startTrigger",
      "blockType": "webhook",
      "editorType": "JavascriptQuery",
      "environment": "production",
      "isMinimized": false,
      "resourceName": "webhook",
      "incomingOnSuccessEdges": []
    },
    {
      "top": 144,
      "left": 560,
      "uuid": "87b21ad4-2368-45d6-9fdd-ba464ad3b88a",
      "pluginId": "levels",
      "blockType": "default",
      "dimensions": { "width": 480, "height": 416 },
      "editorType": "SqlQueryUnified",
      "environment": "production",
      "resourceName": "10d96eaa-fecf-4649-a956-79629779873b",
      "incomingOnSuccessEdges": ["c4fef6f5-7ad9-4036-8225-d62c449c9bf9"]
    },
    {
      "top": 112,
      "left": 1616,
      "uuid": "03fad8d2-514a-4a8c-b3cd-8c035580f2ff",
      "pluginId": "code2",
      "blockType": "code",
      "dimensions": { "width": 560, "height": 528 },
      "editorType": "PythonQuery",
      "environment": "production",
      "resourceName": "PythonQuery",
      "incomingOnSuccessEdges": [
        "87b21ad4-2368-45d6-9fdd-ba464ad3b88a",
        "4ab11681-8700-4d0e-80c0-3c3e5a4b5a64",
        "430cff03-bd36-47ed-970a-b0557e2cb4d3",
        "3debfa4d-c85a-42df-97a1-e40878f29350"
      ]
    },
    {
      "top": 176,
      "left": 2336,
      "uuid": "b109cc04-859c-45be-829e-3a8a924a811f",
      "pluginId": "query1",
      "blockType": "default",
      "editorType": "OpenAPIQuery",
      "environment": "production",
      "resourceName": "6c3602e0-3893-469a-bcc6-3c3fcf26b124",
      "incomingOnSuccessEdges": ["03fad8d2-514a-4a8c-b3cd-8c035580f2ff"]
    },
    {
      "top": -464,
      "left": 576,
      "uuid": "4ab11681-8700-4d0e-80c0-3c3e5a4b5a64",
      "pluginId": "live_categories",
      "blockType": "default",
      "dimensions": { "width": 464, "height": 544 },
      "editorType": "SqlQueryUnified",
      "environment": "production",
      "resourceName": "3f1ad8f5-31c8-443a-b629-4458e698133b",
      "incomingOnSuccessEdges": ["c4fef6f5-7ad9-4036-8225-d62c449c9bf9"]
    },
    {
      "top": 624,
      "left": 576,
      "uuid": "430cff03-bd36-47ed-970a-b0557e2cb4d3",
      "pluginId": "query2",
      "blockType": "default",
      "editorType": "SqlQueryUnified",
      "environment": "production",
      "resourceName": "3f1ad8f5-31c8-443a-b629-4458e698133b",
      "incomingOnSuccessEdges": ["c4fef6f5-7ad9-4036-8225-d62c449c9bf9"]
    },
    {
      "top": 272,
      "left": 2864,
      "uuid": "95020117-f6de-4b97-a248-53c28c87bccc",
      "pluginId": "FailureCondition",
      "blockType": "default",
      "editorType": "OpenAPIQuery",
      "environment": "production",
      "resourceName": "6c3602e0-3893-469a-bcc6-3c3fcf26b124",
      "incomingPorts": [],
      "failureCondition": "true",
      "incomingOnSuccessEdges": []
    },
    {
      "top": 928,
      "left": 560,
      "uuid": "89c0bc8c-ee1e-43e7-bb90-a840ae183dc4",
      "pluginId": "query7",
      "blockType": "default",
      "editorType": "SqlQueryUnified",
      "environment": "production",
      "resourceName": "10d96eaa-fecf-4649-a956-79629779873b",
      "incomingOnSuccessEdges": ["c4fef6f5-7ad9-4036-8225-d62c449c9bf9"]
    },
    {
      "top": 1312,
      "left": 560,
      "uuid": "98c42ce6-26aa-4bb8-90b4-dba3b933a0af",
      "pluginId": "query8",
      "blockType": "default",
      "editorType": "SqlQueryUnified",
      "environment": "production",
      "resourceName": "3f1ad8f5-31c8-443a-b629-4458e698133b",
      "incomingOnSuccessEdges": ["c4fef6f5-7ad9-4036-8225-d62c449c9bf9"]
    },
    {
      "top": 976,
      "left": 1184,
      "uuid": "05bf0c01-6e23-4118-b79d-f1448f96f0f4",
      "pluginId": "query9",
      "blockType": "default",
      "editorType": "SqlTransformQuery",
      "environment": "production",
      "resourceName": "SQL Transforms",
      "incomingOnSuccessEdges": [
        "89c0bc8c-ee1e-43e7-bb90-a840ae183dc4",
        "98c42ce6-26aa-4bb8-90b4-dba3b933a0af"
      ]
    },
    {
      "top": 1040,
      "left": 2816,
      "uuid": "32dc9a9e-5a9a-4d8b-9482-dc9721453a6d",
      "pluginId": "query10",
      "blockType": "default",
      "editorType": "OpenAPIQuery",
      "environment": "production",
      "resourceName": "6c3602e0-3893-469a-bcc6-3c3fcf26b124",
      "incomingOnSuccessEdges": ["bc717039-3e44-41e4-83dd-48a3db638169"]
    },
    {
      "top": 1008,
      "left": 2240,
      "uuid": "bc717039-3e44-41e4-83dd-48a3db638169",
      "pluginId": "code3",
      "blockType": "code",
      "dimensions": { "width": 464, "height": 512 },
      "editorType": "PythonQuery",
      "environment": "production",
      "resourceName": "PythonQuery",
      "incomingPorts": [
        {
          "portId": "dc4eae80-3ee1-437b-aa7d-08c4734eb9a6",
          "blockId": "88de2499-115e-408d-a30d-89f52e33cb97"
        }
      ],
      "incomingOnSuccessEdges": []
    },
    {
      "top": 992,
      "left": 1760,
      "uuid": "88de2499-115e-408d-a30d-89f52e33cb97",
      "options": {
        "conditions": [
          {
            "id": "75441ad0-7925-4169-b13f-4fd9572e8836",
            "type": "if",
            "statement": "query9.data.length > 0",
            "outgoingPortId": "dc4eae80-3ee1-437b-aa7d-08c4734eb9a6"
          }
        ]
      },
      "pluginId": "branch2",
      "blockType": "conditional",
      "editorType": "JavascriptQuery",
      "onboarding": false,
      "environment": "production",
      "isMinimized": false,
      "resourceName": "JavascriptQuery",
      "incomingPorts": [],
      "outgoingPorts": [
        { "id": "dc4eae80-3ee1-437b-aa7d-08c4734eb9a6", "name": "0", "type": "conditional" }
      ],
      "incomingOnSuccessEdges": ["05bf0c01-6e23-4118-b79d-f1448f96f0f4"]
    },
    {
      "top": 384,
      "left": 1040,
      "uuid": "3debfa4d-c85a-42df-97a1-e40878f29350",
      "pluginId": "childs",
      "blockType": "default",
      "dimensions": { "width": 496, "height": 512 },
      "editorType": "SqlQueryUnified",
      "environment": "production",
      "resourceName": "3f1ad8f5-31c8-443a-b629-4458e698133b",
      "incomingOnSuccessEdges": ["c4fef6f5-7ad9-4036-8225-d62c449c9bf9"]
    }
  ],
  "templateData": "[\"~#iR\",[\"^ \",\"n\",\"appTemplate\",\"v\",[\"^ \",\"appMaxWidth\",\"100%\",\"appStyles\",\"\",\"appTesting\",null,\"appThemeId\",null,\"appThemeModeId\",null,\"appThemeName\",null,\"createdAt\",null,\"customComponentCollections\",[],\"customDocumentTitle\",\"\",\"customDocumentTitleEnabled\",false,\"customShortcuts\",[],\"experimentalFeatures\",[\"^ \",\"disableMultiplayerEditing\",false,\"multiplayerEditingEnabled\",false,\"sourceControlTemplateDehydration\",false],\"folders\",[\"~#iL\",[]],\"formAppSettings\",[\"^ \",\"customRedirectUrl\",\"\"],\"inAppRetoolPillAppearance\",\"NO_OVERRIDE\",\"instrumentationEnabled\",false,\"internationalizationSettings\",[\"^ \",\"internationalizationEnabled\",false,\"internationalizationFiles\",[]],\"isFetching\",false,\"isFormApp\",false,\"isGlobalWidget\",false,\"isMobileApp\",false,\"loadingIndicatorsDisabled\",false,\"markdownLinkBehavior\",\"auto\",\"mobileAppSettings\",[\"^ \",\"displaySetting\",[\"^ \",\"landscapeMode\",false,\"tabletMode\",false],\"mobileOfflineModeBannerMode\",\"default\",\"mobileOfflineModeDelaySync\",false,\"mobileOfflineModeEnabled\",false],\"mobileOfflineAssets\",[],\"multiScreenMobileApp\",false,\"notificationsSettings\",[\"^ \",\"globalQueryShowFailureToast\",true,\"globalQueryShowSuccessToast\",false,\"globalQueryToastDuration\",4.5,\"globalToastPosition\",\"bottomRight\"],\"pageCodeFolders\",[\"^ \"],\"pageLoadValueOverrides\",[\"^A\",[]],\"persistUrlParams\",false,\"plugins\",[\"~#iOM\",[\"startTrigger\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"startTrigger\",\"uuid\",null,\"_comment\",null,\"type\",\"datasource\",\"subtype\",\"JavascriptQuery\",\"namespace\",null,\"resourceName\",\"JavascriptQuery\",\"resourceDisplayName\",null,\"template\",[\"~#iM\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"return \",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"style\",null,\"position2\",null,\"mobilePosition2\",null,\"mobileAppPosition\",null,\"tabIndex\",null,\"container\",\"\",\"^7\",\"~m1733336825634\",\"updatedAt\",\"~m1733336825634\",\"folder\",\"\",\"presetName\",null,\"screen\",null,\"boxId\",null,\"subBoxIds\",null]]],\"levels\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"levels\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"10d96eaa-fecf-4649-a956-79629779873b\",\"^1<\",\"retool_db\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT * FROM operation_levels\\nORDER BY category\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^15\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^15\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"operation_levels\",\"queryTimeout\",\"100000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1733336859553\",\"^1E\",\"~m1752073693323\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code2\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code2\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"import pandas as pd\\nfrom datetime import datetime\\nimport random\\n\\n# Data (replace these with your actual data inputs)\\ndata = levels.data\\nquery2_data = query2.data  # Now includes both negative inventory and reserved-hidden\\nchild_data = childs.data\\n\\n# Create DataFrames\\ndf = pd.DataFrame(data)\\nlive_category = pd.DataFrame(live_categories.data)\\nquery2_df = pd.DataFrame(query2_data)\\nchild_df = pd.DataFrame(child_data)\\n\\n# Left join df onto live_category to include all categories from live_category\\ndf = live_category.merge(df, on=\\\"category\\\", how=\\\"left\\\")\\n\\n# Function to calculate days since timestamp\\ndef calculate_days_since(timestamp):\\n    if pd.isna(timestamp) or timestamp is None:\\n        return \\\"N/A\\\"\\n    return (datetime.now() - datetime.fromisoformat(timestamp.replace(\\\"Z\\\", \\\"\\\"))).days\\n\\n# Generate messages function\\ndef generate_messages(df, query2_df, child_df):\\n    \\\"\\\"\\\"\\n    Group by 'category' (using the row with the lowest 'previous_level').\\n    Then categorize each row as:\\n      - Goal Missing\\n      - Red Alert (level 0)\\n      - Orange Alert (level 1)\\n      - Below Goal (level 2)\\n      - Negative Inventory\\n      - Reserved Hidden (enabled but hidden due to reservations)\\n      - Mismatched Child-Parent SKUs\\n    \\\"\\\"\\\"\\n\\n    df = df.sort_values(\\\"previous_level\\\", na_position=\\\"last\\\")\\n    df = df.groupby(\\\"category\\\", as_index=False).first()\\n\\n    goal_missing = []\\n    red_alerts = []\\n    orange_alerts = []\\n    below_goal = []\\n    negative_inventory = []\\n    reserved_hidden = []\\n    child_disabled_parent_enabled = []\\n    child_enabled_parent_disabled = []\\n\\n    for _, row in df.iterrows():\\n        category = row[\\\"category\\\"].split(\\\"|\\\")[0]\\n        name = row[\\\"name\\\"]\\n        critical_level = row.get(\\\"critical_level\\\")\\n        minimum = row.get(\\\"minimum\\\")\\n        goal = row.get(\\\"goal\\\")\\n        previous_level = row.get(\\\"previous_level\\\")\\n        time_turned_red = row.get(\\\"time_turned_red\\\")\\n        time_turned_orange = row.get(\\\"time_turned_orange\\\")\\n        time_turned_yellow = row.get(\\\"time_turned_yellow\\\")\\n\\n        # 1) Handle rows where all inventory data is missing\\n        if pd.isna(critical_level) or pd.isna(minimum) or pd.isna(goal):\\n            goal_missing.append(f\\\"- {category} ({name})\\\")\\n            continue\\n\\n        # 2) Check for red-level alert\\n        if previous_level == 0:\\n            days_below = calculate_days_since(time_turned_red)\\n            red_alerts.append(f\\\"- {category} ({name}): {days_below} days\\\")\\n\\n        # 3) Check for orange-level alert\\n        elif previous_level == 1:\\n            days_below = calculate_days_since(time_turned_orange)\\n            orange_alerts.append(f\\\"- {category} ({name}): {days_below} days\\\")\\n\\n        # 4) Below Goal (level=2)\\n        elif previous_level == 2:\\n            days_below = calculate_days_since(time_turned_yellow)\\n            below_goal.append(f\\\"- {category} ({name}): {days_below} days\\\")\\n\\n    # 5) Process query2 results - split by issue type\\n    if not query2_df.empty:\\n        for _, row in query2_df.iterrows():\\n            issue_type = row.get(\\\"issue_type\\\", \\\"\\\")\\n            sku = row.get(\\\"sku\\\", \\\"\\\")\\n            \\n            if issue_type == \\\"NEGATIVE\\\":\\n                negative_inventory.append(f\\\"- {sku}\\\")\\n            elif issue_type == \\\"RESERVED_HIDDEN\\\":\\n                sku_name = row.get(\\\"name\\\", \\\"\\\")\\n                reserved = row.get(\\\"reserved\\\", 0)\\n                inventory = row.get(\\\"inventory\\\", 0)\\n                reserved_hidden.append(f\\\"- {sku} ({sku_name}) | Inventory: {inventory}, Reserved: {reserved}\\\")\\n\\n    # 6) Process mismatched child-parent SKUs with notes\\n    if not child_df.empty:\\n        for _, row in child_df.iterrows():\\n            child_sku = row.get(\\\"child_sku\\\", \\\"\\\")\\n            parent_sku = row.get(\\\"parent_sku\\\", \\\"\\\")\\n            mismatch_type = row.get(\\\"mismatch_type\\\", \\\"\\\")\\n            notes = row.get(\\\"notes\\\", \\\"\\\")\\n            \\n            if notes and pd.notna(notes):\\n                entry = f\\\"- Child: {child_sku} | Parent: {parent_sku} | Notes: {notes}\\\"\\n            else:\\n                entry = f\\\"- Child: {child_sku} | Parent: {parent_sku}\\\"\\n            \\n            if mismatch_type == \\\"CHILD_DISABLED_PARENT_ENABLED\\\":\\n                child_disabled_parent_enabled.append(entry)\\n            elif mismatch_type == \\\"CHILD_ENABLED_PARENT_DISABLED\\\":\\n                child_enabled_parent_disabled.append(entry)\\n\\n    # Build the report text\\n    report = []\\n    report.append(\\\"üîî Daily Inventory Status Report üîî\\\\n\\\")\\n    report.append(\\\"Status Summary:\\\")\\n    report.append(\\\"----------------------------\\\")\\n\\n    if goal_missing:\\n        report.append(\\\"\\\\nüìù Missing Goals:\\\")\\n        report.extend(goal_missing)\\n    \\n    if red_alerts:\\n        report.append(\\\"\\\\nüî¥ Critical Level Alerts:\\\")\\n        report.extend(red_alerts)\\n    \\n    if orange_alerts:\\n        report.append(\\\"\\\\nüü† Minimum Level Alerts:\\\")\\n        report.extend(orange_alerts)\\n    \\n    if below_goal:\\n        report.append(\\\"\\\\nüü° Below Goal Alerts:\\\")\\n        report.extend(below_goal)\\n\\n    if reserved_hidden:\\n        report.append(\\\"\\\\n‚è∏Ô∏è Enabled but Hidden (reserved inventory):\\\")\\n        report.extend(reserved_hidden)\\n\\n    if child_disabled_parent_enabled:\\n        report.append(\\\"\\\\n‚ö†Ô∏è Child Disabled but Parent Enabled:\\\")\\n        report.extend(child_disabled_parent_enabled)\\n    \\n    if child_enabled_parent_disabled:\\n        report.append(\\\"\\\\n‚ö†Ô∏è Child Enabled but Parent Disabled:\\\")\\n        report.extend(child_enabled_parent_disabled)\\n\\n    # If no alerts are present, add the celebratory message.\\n    if not (goal_missing or red_alerts or orange_alerts or below_goal or negative_inventory \\n            or reserved_hidden or child_disabled_parent_enabled or child_enabled_parent_disabled):\\n        congratulations_messages = [\\n            \\\"‚úÖ Awesome job, every product category is over its goal!\\\",\\n            \\\"‚úÖ Great work, all product categories are exceeding the live product target!\\\",\\n            \\\"‚úÖ Fantastic! Every category has enough live products to soar past the goal!\\\",\\n            \\\"‚úÖ Hooray, every product category is thriving with live products!\\\",\\n            \\\"‚úÖ Bravo, live product goals have been met across all categories!\\\",\\n            \\\"‚úÖ Cheers to everyone ‚Äì all product categories are doing great!\\\",\\n            \\\"‚úÖ Excellent, every category is rocking its live product count!\\\",\\n            \\\"‚úÖ Way to go, every product category is live and exceeding expectations!\\\",\\n            \\\"‚úÖ Yippee, live product counts are at the goal in every category!\\\",\\n            \\\"‚úÖ Hip hip hooray, every live product category has hit its target!\\\"\\n        ]\\n        report.append(\\\"\\\\n\\\" + random.choice(congratulations_messages))\\n\\n    report.append(\\\"\\\\n----------------------------\\\\nEnd of Report\\\")\\n    return \\\"\\\\n\\\".join(report)\\n\\n# Generate and print the messages\\nreturn generate_messages(df, query2_df, child_df)\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^15\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^15\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1733336909889\",\"^1E\",\"~m1769101840920\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query1\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query1\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"OpenAPIQuery\",\"^1:\",null,\"^1;\",\"6c3602e0-3893-469a-bcc6-3c3fcf26b124\",\"^1<\",\"SW Slack\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"requestBodyMetadata\",\"\",\"method\",\"post\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"operationId\",\"chat_postMessage\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"server\",\"\",\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"path\",\"/chat.postMessage\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"autoPaginate\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"parameters\",\"{\\\"channel\\\":\\\"C084Z9EKDSL\\\",\\\"text\\\":\\\"{{ code2.data }}\\\"}\",\"data\",null,\"specPathOverride\",\"\",\"importedQueryInputs\",[\"^15\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"requestBodyDynamicStates\",\"\",\"queryRunTime\",null,\"changesetObject\",\"\",\"requestBody\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"specBasePath\",\"\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"serverVariables\",\"\",\"enableErrorTransformer\",false,\"autoPaginateLimit\",500,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^15\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"parameterDynamicStates\",\"{\\\"attachments\\\":false,\\\"blocks\\\":false,\\\"channel\\\":false,\\\"icon_emoji\\\":false,\\\"icon_url\\\":false,\\\"link_names\\\":false,\\\"mrkdwn\\\":false,\\\"parse\\\":false,\\\"reply_broadcast\\\":false,\\\"text\\\":false,\\\"thread_ts\\\":false,\\\"unfurl_links\\\":false,\\\"unfurl_media\\\":false,\\\"username\\\":false}\",\"parameterMetadata\",\"{\\\"channel\\\":{\\\"label\\\":\\\"live-product-warnings\\\"}}\",\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1733338128679\",\"^1E\",\"~m1748530986882\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"live_categories\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"live_categories\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"3f1ad8f5-31c8-443a-b629-4458e698133b\",\"^1<\",\"SW - Live\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"WITH active_reservations AS (\\n    SELECT product_id, SUM(quantity) as total_reserved\\n    FROM inventory_reservations\\n    WHERE status = 'active'\\n    GROUP BY product_id\\n)\\nSELECT \\n  CONCAT(c.name, '|', rp.product_type) AS category, pt.name\\nFROM receiver_products rp\\nCROSS JOIN (SELECT attribute_value AS default_drop_level FROM feature_attributes WHERE id = 1) fa\\nLEFT JOIN product_type pt ON rp.product_type = pt.id\\nLEFT JOIN category c ON rp.category = c.id\\nLEFT JOIN active_reservations ar ON rp.product_id = ar.product_id\\nWHERE rp.sweet_shoppe = 0 \\n  AND rp.product_type NOT IN (4, 7, 9, 11, 12, 13, 19, 20, 22, 23, 24, \\n                              26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, \\n                              37, 38, 41, 43, 44, 101, 102, 103, 104, 105,  561, 553,551,555)\\n  AND c.name IS NOT NULL \\n  AND c.name != ''\\nGROUP BY \\n  rp.product_type, c.name\\nHAVING \\n  SUM(\\n    CASE \\n      WHEN rp.archive != 1 \\n           AND rp.status = \\\"enabled\\\"\\n           AND rp.deleted_at IS NULL \\n           AND (ISNULL(rp.end_date) OR rp.end_date > rp.created_at)\\n           AND (ISNULL(rp.start_date) OR rp.start_date < rp.created_at)\\n           AND (rp.odoo_inventory - COALESCE(ar.total_reserved, 0)) > COALESCE(rp.drop_level, fa.default_drop_level)\\n      THEN 1\\n      ELSE 0\\n    END\\n  ) > 0\\nORDER BY \\n  rp.product_type;\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^15\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^15\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1734056812550\",\"^1E\",\"~m1764947269787\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query2\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query2\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"3f1ad8f5-31c8-443a-b629-4458e698133b\",\"^1<\",\"SW - Live\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"WITH active_reservations AS (\\n    SELECT product_id, SUM(quantity) as total_reserved\\n    FROM inventory_reservations\\n    WHERE status = 'active'\\n    GROUP BY product_id\\n)\\nSELECT \\n    rp.sku,\\n    rp.name,\\n    rp.odoo_inventory as inventory,\\n    COALESCE(ar.total_reserved, 0) as reserved,\\n    CASE \\n        WHEN rp.odoo_inventory < 0 THEN 'NEGATIVE'\\n        WHEN rp.odoo_inventory - COALESCE(ar.total_reserved, 0) <= COALESCE(rp.drop_level, fa.default_drop_level) THEN 'RESERVED_HIDDEN'\\n    END as issue_type\\nFROM receiver_products rp\\nCROSS JOIN (SELECT attribute_value AS default_drop_level FROM feature_attributes WHERE id = 1) fa\\nLEFT JOIN active_reservations ar ON rp.product_id = ar.product_id\\nWHERE rp.status = 'enabled'\\n  AND (\\n    rp.odoo_inventory < 0 \\n    OR (rp.odoo_inventory - COALESCE(ar.total_reserved, 0) <= COALESCE(rp.drop_level, fa.default_drop_level)\\n        AND COALESCE(ar.total_reserved, 0) > 0)\\n  )\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^15\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^15\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1736197081413\",\"^1E\",\"~m1764867927580\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"FailureCondition\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"FailureCondition\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"OpenAPIQuery\",\"^1:\",null,\"^1;\",\"6c3602e0-3893-469a-bcc6-3c3fcf26b124\",\"^1<\",\"SW Slack\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"requestBodyMetadata\",\"\",\"method\",\"post\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"operationId\",\"chat_postMessage\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"server\",\"\",\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"path\",\"/chat.postMessage\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"autoPaginate\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"parameters\",\"{\\\"channel\\\":\\\"C07GY977AEM\\\",\\\"text\\\":\\\"Daily Operations Message worflow failed to run. <@U022BUNHE1Z>\\\"}\",\"data\",null,\"specPathOverride\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"requestBodyDynamicStates\",\"\",\"queryRunTime\",null,\"changesetObject\",\"\",\"requestBody\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"specBasePath\",\"\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"serverVariables\",\"\",\"enableErrorTransformer\",false,\"autoPaginateLimit\",500,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"parameterDynamicStates\",\"{\\\"attachments\\\":false,\\\"blocks\\\":false,\\\"channel\\\":true,\\\"icon_emoji\\\":false,\\\"icon_url\\\":false,\\\"link_names\\\":false,\\\"mrkdwn\\\":false,\\\"parse\\\":false,\\\"reply_broadcast\\\":false,\\\"text\\\":false,\\\"thread_ts\\\":false,\\\"unfurl_links\\\":false,\\\"unfurl_media\\\":false,\\\"username\\\":false}\",\"parameterMetadata\",\"\",\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1748460898910\",\"^1E\",\"~m1748462051378\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query7\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query7\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"10d96eaa-fecf-4649-a956-79629779873b\",\"^1<\",\"retool_db\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"SELECT * FROM promo_code_alerts\\nWHERE active\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"600000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1751055772856\",\"^1E\",\"~m1752503204725\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query8\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query8\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"3f1ad8f5-31c8-443a-b629-4458e698133b\",\"^1<\",\"SW - Live\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"WITH buyer_coupon_usage AS (\\n  SELECT\\n    CAST(bbd.coupon_code AS CHAR) AS coupon_code,\\n    DATE(b.created_at)              AS created_date,\\n    b.company_id\\n  FROM buyer_orders b\\n  JOIN buyer_order_billing_details bbd\\n    ON b.order_id = bbd.order_id\\n  WHERE bbd.coupon_code IS NOT NULL\\n    AND TRIM(bbd.coupon_code) <> ''\\n    AND b.store_id <> 2\\n    AND b.created_at >= DATE_SUB(CURDATE(), INTERVAL 10 WEEK)\\n),\\npre_coupon_usage AS (\\n  SELECT\\n    CAST(coupon_code AS CHAR) AS coupon_code,\\n    DATE(created_at)           AS created_date,\\n    company_id\\n  FROM preselect_orders\\n  WHERE coupon_code IS NOT NULL\\n    AND TRIM(coupon_code) <> ''\\n    AND created_at >= DATE_SUB(CURDATE(), INTERVAL 10 WEEK)\\n),\\nall_usage AS (\\n  SELECT * FROM buyer_coupon_usage\\n  UNION ALL\\n  SELECT * FROM pre_coupon_usage\\n)\\nSELECT\\n  u.coupon_code,\\n  u.created_date,\\n  DATEDIFF(CURDATE(), u.created_date) AS days_ago,\\n  COUNT(*)                         AS usage_count\\nFROM all_usage u\\nJOIN company c\\n  ON u.company_id = c.id\\n  AND c.test_account = 0\\nGROUP BY\\n  u.coupon_code,\\n  u.created_date\\nORDER BY\\n  u.created_date,\\n  u.coupon_code;\\n\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1751055802877\",\"^1E\",\"~m1752591985873\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query9\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query9\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlTransformQuery\",\"^1:\",null,\"^1;\",\"SQL Transforms\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"WITH alerts AS (SELECT a.promo_code, MAX(a.alert_threshold) AS alert_threshold, MAX(a.alert_period_days) AS alert_period_days,SUM(b.usage_count) AS alert_period_usage FROM {{query7.data }} a \\nLEFT JOIN {{ query8.data }} b ON a.promo_code = b.coupon_code AND a.alert_period_days >= b.days_ago\\nGROUP BY a.promo_code)\\nSELECT * FROM alerts \\nWHERE alert_period_usage > alert_threshold\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1751055902053\",\"^1E\",\"~m1751056084589\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"query10\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"query10\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"OpenAPIQuery\",\"^1:\",null,\"^1;\",\"6c3602e0-3893-469a-bcc6-3c3fcf26b124\",\"^1<\",\"SW Slack\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"requestBodyMetadata\",\"\",\"method\",\"post\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"operationId\",\"chat_postMessage\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"server\",\"\",\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"path\",\"/chat.postMessage\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"autoPaginate\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"parameters\",\"{\\\"channel\\\":\\\"C4086K801\\\",\\\"text\\\":\\\"{{ code3.data }}\\\"}\",\"data\",null,\"specPathOverride\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"requestBodyDynamicStates\",\"\",\"queryRunTime\",null,\"changesetObject\",\"\",\"requestBody\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"specBasePath\",\"\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"serverVariables\",\"\",\"enableErrorTransformer\",false,\"autoPaginateLimit\",500,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"parameterDynamicStates\",\"{\\\"attachments\\\":false,\\\"blocks\\\":false,\\\"channel\\\":false,\\\"icon_emoji\\\":false,\\\"icon_url\\\":false,\\\"link_names\\\":false,\\\"mrkdwn\\\":false,\\\"parse\\\":false,\\\"reply_broadcast\\\":false,\\\"text\\\":false,\\\"thread_ts\\\":false,\\\"unfurl_links\\\":false,\\\"unfurl_media\\\":false,\\\"username\\\":false}\",\"parameterMetadata\",\"{\\\"channel\\\":{\\\"label\\\":\\\"billing\\\"}}\",\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1751056100744\",\"^1E\",\"~m1751057709261\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"code3\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"code3\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"PythonQuery\",\"^1:\",null,\"^1;\",\"PythonQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"def craft_slack_alert(data, user_ids=None):\\n    \\\"\\\"\\\"\\n    data: list of dicts as before\\n    user_ids: list of Slack user IDs to ping (e.g. [\\\"UMSMMGL22\\\", \\\"U016PP8V8EN\\\"])\\n    \\\"\\\"\\\"\\n    if user_ids is None:\\n        user_ids = [\\\"UMSMMGL22\\\", \\\"U016PP8V8EN\\\"]\\n    # build a space-separated string like \\\"<@UMSMMGL22> <@U016PP8V8EN>\\\"\\n    mention = \\\" \\\".join(f\\\"<@{uid}>\\\" for uid in user_ids)\\n\\n    messages = []\\n    for item in data:\\n        promo     = item.get('promo_code', 'UNKNOWN')\\n        threshold = item.get('alert_threshold', 0)\\n        days      = item.get('alert_period_days', 0)\\n        usage     = item.get('alert_period_usage', 0)\\n\\n        if usage >= threshold:\\n            messages.append(\\n                f\\\"{mention} :warning: Promo Code *{promo}* has reached its threshold of \\\"\\n                f\\\"{threshold} uses in the last {days} days (actual: {usage}).\\\"\\n            )\\n        else:\\n            messages.append(\\n                f\\\":white_check_mark: Promo *{promo}* is still below threshold: \\\"\\n                f\\\"{usage}/{threshold} uses in {days} days.\\\"\\n            )\\n\\n    return \\\"\\\\n\\\".join(messages)\\n\\n# Usage:\\nalert_message = craft_slack_alert(query9.data)\\nreturn alert_message\\n\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1751056158968\",\"^1E\",\"~m1751057617796\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"branch2\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"branch2\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"JavascriptQuery\",\"^1:\",null,\"^1;\",\"JavascriptQuery\",\"^1<\",null,\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"if (query9.data.length > 0) {\\n  executePathAtMostOnce('0')\\n}\\n\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"data\",null,\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"cacheKeyTtl\",\"\",\"requestSentTimestamp\",null,\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"changesetObject\",\"\",\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1751056441425\",\"^1E\",\"~m1751056460908\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]],\"childs\",[\"^0\",[\"^ \",\"n\",\"pluginTemplate\",\"v\",[\"^ \",\"id\",\"childs\",\"^16\",null,\"^17\",null,\"^18\",\"datasource\",\"^19\",\"SqlQueryUnified\",\"^1:\",null,\"^1;\",\"3f1ad8f5-31c8-443a-b629-4458e698133b\",\"^1<\",\"SW - Live\",\"^1=\",[\"^1>\",[\"queryRefreshTime\",\"\",\"allowedGroupIds\",[\"^A\",[]],\"streamResponse\",false,\"records\",\"\",\"lastReceivedFromResourceAt\",null,\"isFunction\",false,\"databasePasswordOverride\",\"\",\"functionParameters\",null,\"queryDisabledMessage\",\"\",\"servedFromCache\",false,\"offlineUserQueryInputs\",\"\",\"functionDescription\",null,\"successMessage\",\"\",\"queryDisabled\",\"\",\"playgroundQuerySaveId\",\"latest\",\"workflowParams\",null,\"resourceNameOverride\",\"\",\"runWhenModelUpdates\",false,\"workflowRunExecutionType\",\"sync\",\"showFailureToaster\",true,\"query\",\"WITH filtered AS (\\n  SELECT\\n      rp.sku,\\n      rp.notes,\\n      LEFT(rp.sku, 11)           AS base_sku,\\n      (CHAR_LENGTH(rp.sku) = 11) AS is_parent,\\n      LOWER(rp.status)           AS status_lc\\n  FROM receiver_products rp\\n  LEFT JOIN product_type pt ON rp.product_type = pt.id\\n  LEFT JOIN category     cat ON rp.category = cat.id\\n  WHERE rp.sweet_shoppe = 0\\n    AND rp.product_type NOT IN (4, 7, 9, 11, 12, 13, 19, 20, 22, 23, 24,\\n                                26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,\\n                                37, 38, 41, 43, 44, 101, 102, 103, 104, 105,  561, 553,551,555)\\n    AND cat.name IS NOT NULL\\n    AND cat.name != ''\\n    AND rp.archive != 1\\n    AND rp.deleted_at IS NULL\\n    AND (ISNULL(rp.end_date)   OR rp.end_date   > rp.created_at)\\n    AND (ISNULL(rp.start_date) OR rp.start_date < rp.created_at)\\n),\\nproducts AS (\\n  SELECT\\n      sku,\\n      base_sku,\\n      is_parent,\\n      notes,\\n      CASE WHEN status_lc = 'enabled' THEN 1 ELSE 0 END AS is_active\\n  FROM filtered\\n)\\nSELECT\\n  c.sku AS child_sku,\\n  p.sku AS parent_sku,\\n  COALESCE(c.notes, p.notes) AS notes,\\n  CASE\\n    WHEN c.is_active = 0 AND p.is_active = 1 THEN 'CHILD_DISABLED_PARENT_ENABLED'\\n    WHEN c.is_active = 1 AND p.is_active = 0 THEN 'CHILD_ENABLED_PARENT_DISABLED'\\n  END AS mismatch_type\\nFROM products c\\nJOIN products p\\n  ON p.base_sku = c.base_sku\\n AND p.is_parent = 1\\nWHERE c.is_parent = 0\\n  AND (\\n        (c.is_active = 0 AND p.is_active = 1)\\n     OR (c.is_active = 1 AND p.is_active = 0)\\n  )\\n  AND c.notes != 'USE THIS IF BELOW GOAL. DISABLE WHEN MAIN SKUS ARE BACK'\\nORDER BY mismatch_type, parent_sku, child_sku\\n\",\"playgroundQueryUuid\",\"\",\"playgroundQueryId\",null,\"error\",null,\"workflowRunBodyType\",\"raw\",\"privateParams\",[\"^A\",[]],\"queryRunOnSelectorUpdate\",false,\"runWhenPageLoadsDelay\",\"\",\"warningCodes\",[\"^A\",[]],\"data\",null,\"recordId\",\"\",\"importedQueryInputs\",[\"^1>\",[]],\"_additionalScope\",[\"^A\",[]],\"isImported\",false,\"showSuccessToaster\",true,\"dataArray\",[\"^A\",[]],\"cacheKeyTtl\",\"\",\"filterBy\",\"\",\"requestSentTimestamp\",null,\"databaseHostOverride\",\"\",\"metadata\",null,\"editorMode\",\"sql\",\"queryRunTime\",null,\"actionType\",\"\",\"changesetObject\",\"\",\"shouldUseLegacySql\",false,\"offlineOptimisticResponse\",null,\"errorTransformer\",\"return data.error\",\"finished\",null,\"databaseNameOverride\",\"\",\"confirmationMessage\",null,\"isFetching\",false,\"changeset\",\"\",\"rawData\",null,\"queryTriggerDelay\",\"0\",\"resourceTypeOverride\",null,\"watchedParams\",[\"^A\",[]],\"enableErrorTransformer\",false,\"databaseWarehouseOverride\",\"\",\"enableBulkUpdates\",false,\"showLatestVersionUpdatedWarning\",false,\"timestamp\",0,\"evalType\",\"script\",\"importedQueryDefaults\",[\"^1>\",[]],\"enableTransformer\",false,\"showUpdateSetValueDynamicallyToggle\",true,\"overrideOrgCacheForUserCache\",false,\"bulkUpdatePrimaryKey\",\"\",\"runWhenPageLoads\",false,\"transformer\",\"return data\",\"events\",[\"^A\",[]],\"tableName\",\"\",\"queryTimeout\",\"10000\",\"workflowId\",null,\"requireConfirmation\",false,\"queryFailureConditions\",\"\",\"changesetIsObject\",false,\"enableCaching\",false,\"allowedGroups\",[\"^A\",[]],\"databaseUsernameOverride\",\"\",\"databaseRoleOverride\",\"\",\"shouldEnableBatchQuerying\",false,\"doNotThrowOnNoOp\",false,\"offlineQueryType\",\"None\",\"queryThrottleTime\",\"750\",\"updateSetValueDynamically\",false,\"notificationDuration\",\"\"]],\"^1?\",null,\"^1@\",null,\"^1A\",null,\"^1B\",null,\"^1C\",null,\"^1D\",\"\",\"^7\",\"~m1756922304959\",\"^1E\",\"~m1764947277053\",\"^1F\",\"\",\"^1G\",null,\"^1H\",null,\"^1I\",null,\"^1J\",null]]]]],\"preloadedAppJavaScript\",null,\"preloadedAppJSLinks\",[],\"queryStatusVisibility\",false,\"responsiveLayoutDisabled\",false,\"rootScreen\",null,\"savePlatform\",\"web\",\"shortlink\",null,\"testEntities\",[],\"tests\",[],\"urlFragmentDefinitions\",[\"^A\",[]],\"version\",\"3.327.0\",\"serializedLayout\",null,\"agentEvals\",[\"^ \"]]]]",
  "triggerWebhooks": [
    {
      "name": "startTrigger",
      "uuid": "startTrigger",
      "inputSchema": { "properties": [] },
      "useHeaderApiKey": false,
      "exampleInputJSON": ""
    }
  ],
  "customLibraries": [
    {
      "version": "4.17.21",
      "language": "javascript",
      "variable": "_",
      "codeString": "/* Edit library variable below */\n\nconst _ = require('lodash')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n",
      "libraryName": "lodash"
    },
    {
      "version": "2.1.0",
      "language": "javascript",
      "variable": "numbro",
      "codeString": "/* Edit library variable below */\n\nconst numbro = require('numbro')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n",
      "libraryName": "numbro"
    },
    {
      "version": "5.3.2",
      "language": "javascript",
      "variable": "Papa",
      "codeString": "/* Edit library variable below */\n\nconst Papa = require('papaparse')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n",
      "libraryName": "papaparse"
    },
    {
      "version": "0.5.23",
      "language": "javascript",
      "variable": "moment",
      "codeString": "/* Edit library variable below */\n\nconst moment = require('moment-timezone')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n",
      "libraryName": "moment-timezone"
    },
    {
      "version": "3.4.0",
      "language": "javascript",
      "variable": "uuid",
      "codeString": "/* Edit library variable below */\n\nconst uuid = require('uuid')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n",
      "libraryName": "uuid"
    }
  ],
  "createdBy": 1396958,
  "protected": false,
  "setupScripts": {
    "python": { "codeString": "" },
    "javascript": {
      "codeString": "// lodash\n/* Edit library variable below */\n\nconst _ = require('lodash')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n\n// numbro\n/* Edit library variable below */\n\nconst numbro = require('numbro')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n\n// papaparse\n/* Edit library variable below */\n\nconst Papa = require('papaparse')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n\n// moment-timezone\n/* Edit library variable below */\n\nconst moment = require('moment-timezone')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n\n// uuid\n/* Edit library variable below */\n\nconst uuid = require('uuid')\n\n/* Add destructured imports from library below\neg. const { pow, log } = require(\"mathjs\") */\n"
    }
  },
  "subflows": [],
  "type": "workflow",
  "iconName": null,
  "iconColor": null,
  "hasProtectedTriggers": false,
  "protectedTriggers": [],
  "readme": null
}
